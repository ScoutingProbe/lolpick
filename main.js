const {app, BrowserWindow, globalShortcut, ipcMain} = require('electron')
const path = require('path')
const url = require('url')
const fs = require('fs')


const location = require('./back/location.js')
const summonery = require('./back/summonery.js')

const client = require('./league/client.js')

const lolcounter = require('./lolcounter/lolcounter.js')
const lolcounterRetry = require('./lolcounter/lolcounterRetry.js')

const championMastery = require('./riotgames/championMastery.js')
const champions = require('./riotgames/champions.js')
const league = require('./riotgames/league.js')
// const lolStaticData
// const lolStatus
const match = require('./riotgames/match.js')
// const spectator
const summoner = require('./riotgames/summoner.js')
// const thirdPartyCode
// const tournamentStub
// const tournament

let win

function createWindow() {
	win = new BrowserWindow({width: 1000, height: 850})
	win.loadURL('http://localhost:3000')

	win.on('closed', () => {
		win = null
	})
}

app.on('activate', () => {
	if (win === null) {
		createWindow()
	}
})

app.on('window-all-closed', () => {
	app.quit()
})

app.on('ready', createWindow)

app.on('ready', () => {
	globalShortcut.register('F5', () => {
		console.log('f5 pressed')
	})
})

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//language form
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
// riotgames form
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

ipcMain.on('riotgames', (event, region, s)=>{
	summoner.initial(win, region, s)
	.then(championMastery.initial)
	.then(league.initial)
	.then(match.initial)
	.then(champions.initial)
	.catch(error=>{
		console.log(error)
	})
})

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
// lolcounter form
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
ipcMain.on('lolcounter', event=>{
	lolcounter.initial(win)
})

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
// summonery champion cards
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

ipcMain.on('summonery', (event, sortKey, lane, count)=>{
	summonery.initial(win, sortKey, lane, count)
})

ipcMain.on('lolcounter-retry', (event, id, relation, lane, slice)=>{
	lolcounterRetry.initial(win, id, relation, lane, slice)
})

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//location form
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
ipcMain.on('location', (event, loc) => {
	location.initial(win, loc)
})

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
// league of legends client
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

ipcMain.on('client', (event, loc)=>{
	client.initial(new Array(win, loc, 0))
})